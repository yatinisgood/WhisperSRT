1
00:00:00,000 --> 00:00:02,460
假如你有1萬張A100顯卡

2
00:00:02,460 --> 00:00:05,000
你將如何去管理使用它們呢

3
00:00:05,000 --> 00:00:07,640
我是換方的AI應用工程師

4
00:00:07,640 --> 00:00:10,100
剛剛的問題就是我的工作日常

5
00:00:10,100 --> 00:00:12,440
這並不是什麼算力反爾賽

6
00:00:12,440 --> 00:00:17,580
雖然社交網站上把上千卡跑一次的大模型調侃為豪門

7
00:00:17,580 --> 00:00:19,480
但從我的角度來看

8
00:00:19,480 --> 00:00:22,760
要讓這個算力巨獸發揮出它真正的戰力

9
00:00:22,760 --> 00:00:24,920
除了興奮更多的是挑戰

10
00:00:24,920 --> 00:00:29,180
它不僅僅是把千卡甚至萬卡堆積起來使用

11
00:00:29,180 --> 00:00:31,120
這隻能說只是個開始

12
00:00:31,120 --> 00:00:34,540
而我們團隊所需要構建的是雙倍

13
00:00:34,540 --> 00:00:38,260
甚至於三倍於傳統集群使用率的AI基礎設施

14
00:00:38,260 --> 00:00:43,340
讓一行代碼就可以輕鬆調用的AI訓練服務

15
00:00:43,340 --> 00:00:45,940
想做成這樣的事情非常的不容易

16
00:00:45,940 --> 00:00:48,680
我們也沒有前任的經驗可以參考

17
00:00:48,680 --> 00:00:51,520
從集群節點拓撲結構的設計

18
00:00:51,520 --> 00:00:54,300
到PyTouch深度學習框架的改良

19
00:00:54,300 --> 00:00:57,780
存儲 網絡 通訊 算子優化等等

20
00:00:57,780 --> 00:00:58,880
都需要我們自己

21
00:00:58,880 --> 00:00:59,760
紮根進去

22
00:00:59,760 --> 00:01:02,440
基於硬件的特性不斷的去試錯

23
00:01:02,440 --> 00:01:06,700
在內外用戶的使用反饋當中去進行迭代和升級

24
00:01:06,700 --> 00:01:10,560
比如我入職後不久就碰到的集群升級之後

25
00:01:10,560 --> 00:01:12,580
模型訓練突然就降速的問題

26
00:01:12,580 --> 00:01:15,640
這些任務讀取數據非常的緩慢

27
00:01:15,640 --> 00:01:17,700
Checkpoint也沒有保存成功

28
00:01:17,700 --> 00:01:19,880
在debug的過程當中

29
00:01:19,880 --> 00:01:22,820
網上也沒有任何的資料能給我們作為參考

30
00:01:22,820 --> 00:01:26,780
我們從軟件層的一個個的斷點去排查

31
00:01:26,780 --> 00:01:28,560
到硬件設備的插拔輪換

32
00:01:28,880 --> 00:01:30,800
前後幾輪覆盤之後

33
00:01:30,800 --> 00:01:32,000
最終才定位到

34
00:01:32,000 --> 00:01:33,680
原來這個問題的元兇

35
00:01:33,680 --> 00:01:37,760
是大小兩個網絡交換機協議衝突的一個問題

36
00:01:37,760 --> 00:01:42,360
而最終我們的解決方案也被英偉達官方所收錄

37
00:01:42,360 --> 00:01:45,560
作為案例提供給了其他的開發者

38
00:01:45,560 --> 00:01:47,480
也就在那個時候開始

39
00:01:47,480 --> 00:01:48,760
讓我突然覺得

40
00:01:48,760 --> 00:01:52,880
原來我們已經是一個站在了全球技術前沿的團隊了

41
00:01:52,880 --> 00:01:54,560
現在呢

42
00:01:54,560 --> 00:01:56,840
每天有上千個AI大模型

43
00:01:56,840 --> 00:01:58,760
在換方營火平臺上進行訓練

44
00:01:58,880 --> 00:02:00,760
服務著金融量化

45
00:02:00,760 --> 00:02:01,640
NLP

46
00:02:01,640 --> 00:02:03,280
生物分子結構預測

47
00:02:03,280 --> 00:02:05,720
自動駕駛等諸多前沿場景

48
00:02:05,720 --> 00:02:08,800
每當看到模型的訓練快速的完成

49
00:02:08,800 --> 00:02:10,640
並且跑出經驗的效果

50
00:02:10,640 --> 00:02:14,200
都會讓我覺得大家所做的事情非常的有價值

51
00:02:14,200 --> 00:02:16,840
有一種AI時代的使命感

52
00:02:16,840 --> 00:02:19,120
身處在這個團隊

53
00:02:19,120 --> 00:02:20,800
給我的感覺就是快樂

54
00:02:20,800 --> 00:02:23,500
很幸運能夠和天才們一起共事

55
00:02:23,500 --> 00:02:25,020
我們提出一個問題

56
00:02:25,020 --> 00:02:26,720
能獲得無數的迴響

57
00:02:26,720 --> 00:02:28,640
而不是身邊只有沒有想法

58
00:02:28,640 --> 00:02:28,860
小說一句

59
00:02:28,880 --> 00:02:30,760
一隻小土豆瞪著無辜的大眼睛

60
00:02:30,760 --> 00:02:31,740
問你該怎麼辦

61
00:02:31,740 --> 00:02:34,320
空留你一個人在荒野裡面呼號

62
00:02:34,320 --> 00:02:38,120
前陣子我們在討論一個核心算子的時候

63
00:02:38,120 --> 00:02:40,460
某提到這個算子

64
00:02:40,460 --> 00:02:42,600
它GPU使用率不是很高

65
00:02:42,600 --> 00:02:44,680
有沒有更多提升空間了

66
00:02:44,680 --> 00:02:47,480
當時我是持懷疑態度的

67
00:02:47,480 --> 00:02:49,540
畢竟這是官方提供的算子

68
00:02:49,540 --> 00:02:51,500
是當時最快的實現

69
00:02:51,500 --> 00:02:54,960
他們有最硬件架構最深刻的理解

70
00:02:54,960 --> 00:02:58,160
但最終的結果也只有這樣

71
00:02:58,160 --> 00:02:58,640
那我們來看看

72
00:02:58,640 --> 00:03:01,280
那我們還能做些什麼呢

73
00:03:01,280 --> 00:03:02,840
但我們並沒有放棄

74
00:03:02,840 --> 00:03:05,680
畢竟人生苦短何妨一試

75
00:03:05,680 --> 00:03:07,600
和我們的同學一起苦悶掙扎

76
00:03:07,600 --> 00:03:09,880
山重水負了一個月之後

77
00:03:09,880 --> 00:03:11,920
那天我在回家路上

78
00:03:11,920 --> 00:03:14,520
看上去依舊是毫無收穫的一天

79
00:03:14,520 --> 00:03:16,200
他電話給我說

80
00:03:16,200 --> 00:03:16,520
哎呀

81
00:03:16,520 --> 00:03:19,160
他說他走在路上一陣涼風襲來

82
00:03:19,160 --> 00:03:21,880
他突然之間領悟了

83
00:03:21,880 --> 00:03:24,560
而現在版本在最弱的情況下

84
00:03:24,560 --> 00:03:26,440
比官方快了五倍

85
00:03:26,440 --> 00:03:28,400
普遍情況下快了25%

86
00:03:28,400 --> 00:03:31,720
直接幫我們節省了25%的GPU時間

87
00:03:31,720 --> 00:03:34,540
這就是我們做事的方式

88
00:03:34,540 --> 00:03:37,160
我們的追求並不僅僅在

89
00:03:37,160 --> 00:03:39,080
我比過去快了多少

90
00:03:39,080 --> 00:03:41,640
我比之前的代碼快了25%

91
00:03:41,640 --> 00:03:45,960
我們追求的是我達到理論的最大值

92
00:03:45,960 --> 00:03:47,420
是百分之多少

93
00:03:47,420 --> 00:03:49,200
比如我們的存儲指標

94
00:03:49,200 --> 00:03:51,440
是用了IB帶寬的百分之多少

95
00:03:51,440 --> 00:03:54,420
從80%到85%

96
00:03:54,420 --> 00:03:57,040
到91% 92% 93%

97
00:03:57,040 --> 00:03:58,380
這一步步跑了很多年

98
00:03:58,400 --> 00:04:00,360
這種人會下滑上來

99
00:04:00,360 --> 00:04:04,200
而這種1% 1%的極限追求和突破

100
00:04:04,200 --> 00:04:07,300
在此之前都是不敢想象的

101
00:04:07,300 --> 00:04:10,040
程序員其實並不害怕困難

102
00:04:10,040 --> 00:04:12,480
我寧可為了1%的性能突破

103
00:04:12,480 --> 00:04:13,880
但經節律一個月

104
00:04:13,880 --> 00:04:15,480
也不要面向谷歌編程

105
00:04:15,480 --> 00:04:17,240
寫一些沒有挑戰的代碼

106
00:04:17,240 --> 00:04:18,280
雖然很難

107
00:04:18,280 --> 00:04:19,740
但我並不會感到累

108
00:04:19,740 --> 00:04:22,320
反而後者這些枯燥的編程

109
00:04:22,320 --> 00:04:24,640
會消磨一個人的天賦

110
00:04:24,640 --> 00:04:27,080
我們已經站在非常前沿的位置

111
00:04:27,080 --> 00:04:28,400
遇到的都是各種全新的問題

112
00:04:28,400 --> 00:04:31,000
而和科研天才們一起死磕一個問題

113
00:04:31,000 --> 00:04:33,020
帶來激情是難以想象的

114
00:04:33,020 --> 00:04:36,060
而最終功課難題所帶來的成就感

115
00:04:36,060 --> 00:04:39,780
就是我作為程序員所能得到的最大快樂

116
00:04:39,780 --> 00:04:43,480
作為一個優秀的軟件工程師

117
00:04:43,480 --> 00:04:45,920
你理想的工作是什麼樣子的呢

118
00:04:45,920 --> 00:04:49,480
你又有沒有想過你那一身出色的技能

119
00:04:49,480 --> 00:04:52,180
到底能夠創造出什麼樣的價值呢

120
00:04:52,180 --> 00:04:54,400
我們思考過這個問題

121
00:04:54,400 --> 00:04:57,040
發現答案大概就是成就感

122
00:04:57,040 --> 00:04:59,560
這種成就感來自於工程落地

123
00:04:59,560 --> 00:05:01,200
創造的巨大商業價值

124
00:05:01,200 --> 00:05:02,380
往大了說

125
00:05:02,380 --> 00:05:05,100
它來自於站在世界技術的前沿

126
00:05:05,100 --> 00:05:07,700
引領了方向製造標準

127
00:05:07,700 --> 00:05:08,540
舉例而言

128
00:05:08,540 --> 00:05:11,120
我們用來為迪奧訓練讀取樣本的

129
00:05:11,120 --> 00:05:12,760
變形文件系統非常的快

130
00:05:12,760 --> 00:05:15,020
它快到一個什麼地步呢

131
00:05:15,020 --> 00:05:17,940
我們根本就不需要用緩存

132
00:05:17,940 --> 00:05:19,820
來幫助我們提升讀取的速度

133
00:05:19,820 --> 00:05:22,880
從服務端的磁盤到應用的buffer

134
00:05:22,880 --> 00:05:24,380
沒有一次內存拷貝

135
00:05:24,380 --> 00:05:26,300
從硬盤到內存

136
00:05:26,300 --> 00:05:27,780
內存到網卡

137
00:05:27,780 --> 00:05:30,040
然後就直接從客戶端的網卡

138
00:05:30,040 --> 00:05:31,320
來到了應用的buffer裡

139
00:05:31,320 --> 00:05:33,640
我們針對讀取的每一步

140
00:05:33,640 --> 00:05:35,340
都做了分析和優化

141
00:05:35,340 --> 00:05:37,060
幹掉了所有的內存拷貝

142
00:05:37,060 --> 00:05:38,820
也就得到了極致的性能

143
00:05:38,820 --> 00:05:42,440
我們還有先進的任務級分時調度系統

144
00:05:42,440 --> 00:05:44,040
超高性能的AI算子

145
00:05:44,040 --> 00:05:45,800
以及能夠將迪奧訓練延伸到

146
00:05:45,800 --> 00:05:48,060
多臺機器上併發執行的通訊框架

147
00:05:48,060 --> 00:05:50,440
這一切都是由一個年輕的

148
00:05:50,440 --> 00:05:52,680
充滿活力的螢火工程師團隊

149
00:05:52,680 --> 00:05:56,100
在短短几年的應用實戰中打造出來的

150
00:05:56,100 --> 00:05:58,660
而接下來軟件的極致提升

151
00:05:58,660 --> 00:06:00,540
硬件性能的進一步壓榨

152
00:06:00,540 --> 00:06:03,120
更多無人踏足過的技術難題

153
00:06:03,120 --> 00:06:04,740
將帶給我們更多的挑戰

154
00:06:04,740 --> 00:06:08,060
而螢火團隊會依然帶著驕傲一起分發

155
00:06:08,060 --> 00:06:10,280
身處這樣一個團隊當中

156
00:06:10,280 --> 00:06:12,300
會是一種理想的工作狀態

157
00:06:12,300 --> 00:06:14,340
由成就感驅動了我們

158
00:06:14,340 --> 00:06:16,540
創造了想象不到的價值

159
00:06:16,540 --> 00:06:18,820
2016年

160
00:06:18,820 --> 00:06:21,300
在AlphaGo擊敗李適時後不久

161
00:06:21,300 --> 00:06:23,860
我們上線了第一個深度學習的模型

162
00:06:23,860 --> 00:06:25,840
最初的模型只是一個

163
00:06:25,840 --> 00:06:26,760
MLP網絡

164
00:06:26,760 --> 00:06:28,120
模型很簡單

165
00:06:28,120 --> 00:06:30,300
但有著讓人驚歎的建模能力

166
00:06:30,300 --> 00:06:31,900
從那以後

167
00:06:31,900 --> 00:06:34,960
我們一直在深度學習方面進行持續投入

168
00:06:34,960 --> 00:06:38,800
現在序列模型不僅可以利用當下的信息

169
00:06:38,800 --> 00:06:40,820
還能靈活地使用過去幾分鐘

170
00:06:40,820 --> 00:06:43,800
幾天甚至幾個月發生的事件

171
00:06:43,800 --> 00:06:45,040
自然源處理

172
00:06:45,040 --> 00:06:47,140
讓模型學會理解新聞

173
00:06:47,140 --> 00:06:51,220
快人一步對信息做出反應

174
00:06:51,220 --> 00:06:53,740
圖神經網絡可以整合產業鏈數據

175
00:06:53,740 --> 00:06:55,700
發掘公司之間的關係

176
00:06:55,840 --> 00:06:58,600
同時對整個市場進行建模

177
00:06:58,600 --> 00:07:00,440
利用強化學習

178
00:07:00,440 --> 00:07:04,600
交易的細節可以隨著市場的變化自主地改進

179
00:07:04,600 --> 00:07:06,360
通過對抗訓練

180
00:07:06,360 --> 00:07:09,320
模型可以抑制自己的過度自信

181
00:07:09,320 --> 00:07:11,720
避免落入歷史的陷阱

182
00:07:11,720 --> 00:07:14,720
我們幾乎涉及了深度學習的所有領域

183
00:07:14,720 --> 00:07:18,440
並且時刻保持對前沿發展方向的密切關注

184
00:07:18,440 --> 00:07:22,240
想盡一切辦法來提升預測能力

185
00:07:22,240 --> 00:07:24,960
藉助AI的力量

186
00:07:24,960 --> 00:07:25,760
我們能夠

187
00:07:25,760 --> 00:07:27,840
更加精準地理解市場

188
00:07:27,840 --> 00:07:30,160
讓資產價格能夠更加迅速

189
00:07:30,160 --> 00:07:33,320
更加完整地反映現實世界的規律

190
00:07:33,320 --> 00:07:36,040
我們希望AI為我們帶來的收益

191
00:07:36,040 --> 00:07:40,680
可以反過來推動技術科學研究的進一步發展

192
00:07:40,680 --> 00:07:44,560
我們贊助和推動的科研和量化交易無關

193
00:07:44,560 --> 00:07:46,000
而是無人駕駛

194
00:07:46,000 --> 00:07:48,360
生物製藥等方向

195
00:07:48,360 --> 00:07:50,440
截止到2022年第一季度

196
00:07:50,440 --> 00:07:55,680
螢火AI超算已經服務了50多個國內外的高效實驗室

197
00:07:55,760 --> 00:07:57,200
以及科研機構

198
00:07:57,200 --> 00:08:01,600
累計提供了超過270萬小時的GPU算力

199
00:08:01,600 --> 00:08:04,840
在協助科研機構使用螢火超算的同時

200
00:08:04,840 --> 00:08:07,880
我們也在著手建立自己的科研團隊

201
00:08:07,880 --> 00:08:11,040
讓頂尖的頭腦可以藉助AI的力量

202
00:08:11,040 --> 00:08:14,160
進一步拓展科學的邊界

203
00:08:14,160 --> 00:08:16,720
從圖像分類到機器翻譯

204
00:08:16,720 --> 00:08:19,600
從圍棋佈局到蛋白結構

205
00:08:19,600 --> 00:08:22,320
AI在一個個領域攻城掠地

206
00:08:22,320 --> 00:08:25,360
但是對於AI是否能夠用於資產定價

207
00:08:25,360 --> 00:08:30,040
並且進行交易盈利的問題卻一直存在巨大的爭議

208
00:08:30,040 --> 00:08:31,520
在金融市場中

209
00:08:31,520 --> 00:08:34,040
大家盈利的方式可謂八仙過海

210
00:08:34,040 --> 00:08:35,440
各顯神通

211
00:08:35,440 --> 00:08:36,800
有宏觀分析

212
00:08:36,800 --> 00:08:38,520
股票的基本面分析

213
00:08:38,520 --> 00:08:41,040
還有行為金融學等等

214
00:08:41,040 --> 00:08:45,360
所有的參與者隨著市場變化而不斷挑戰過去的自己

215
00:08:45,360 --> 00:08:47,040
挑戰現在的對手

216
00:08:47,040 --> 00:08:48,880
挑戰未知的前路

217
00:08:48,880 --> 00:08:51,320
與學術界常見的圍棋

218
00:08:51,320 --> 00:08:52,200
遊戲

219
00:08:52,200 --> 00:08:53,120
CV

220
00:08:53,120 --> 00:08:55,240
NLP等任務相比

221
00:08:55,240 --> 00:08:58,200
股價預測是一個參與玩家眾多

222
00:08:58,200 --> 00:08:59,600
信息不完整

223
00:08:59,600 --> 00:09:01,160
信照比極低

224
00:09:01,160 --> 00:09:05,600
數據分佈不斷變化的時序預測問題加博弈問題

225
00:09:05,600 --> 00:09:08,040
複雜程度高一個量級以上

226
00:09:08,040 --> 00:09:09,200
正因為如此

227
00:09:09,200 --> 00:09:10,120
它很有趣

228
00:09:10,120 --> 00:09:11,760
並且充滿挑戰

229
00:09:11,760 --> 00:09:15,560
像一個超大的一字出續集的開放式遊戲

230
00:09:15,560 --> 00:09:17,520
你可以使用任何道具

231
00:09:17,520 --> 00:09:20,200
可以充值買顯卡算力裝備

232
00:09:20,200 --> 00:09:22,520
可以不斷壯大自己的隊伍

233
00:09:22,520 --> 00:09:23,560
在遊戲中

234
00:09:23,560 --> 00:09:25,120
你會遇到新的對手

235
00:09:25,240 --> 00:09:27,080
會遇到策略失效

236
00:09:27,080 --> 00:09:29,600
也會因為新的進展而興奮

237
00:09:29,600 --> 00:09:32,400
同時收穫金錢和成就感

238
00:09:32,400 --> 00:09:34,560
不能把研究結果公諸於眾

239
00:09:34,560 --> 00:09:36,560
或許是唯一的遺憾

240
00:09:36,560 --> 00:09:39,720
因為眾所周知的策略必將失效

241
00:09:39,720 --> 00:09:44,000
而這正是很多人說AI無法預測股價的原因

242
00:09:44,000 --> 00:09:46,400
從數據處理到模型調優

243
00:09:46,400 --> 00:09:48,640
每一個坑都需要踩過來

244
00:09:48,640 --> 00:09:52,880
在這條漫長曲折的道路上披荊斬棘前行時

245
00:09:52,880 --> 00:09:54,040
時間和市場

246
00:09:55,240 --> 00:09:57,320
最為豐厚的回報

247
00:09:57,320 --> 00:10:00,880
官方有一個非常扁平而靈活的團隊架構

248
00:10:00,880 --> 00:10:03,440
我們鼓勵內部不同小組的成員之間

249
00:10:03,440 --> 00:10:05,240
自由交流和合作

250
00:10:05,240 --> 00:10:08,040
去最大化我們整體的創新能力

251
00:10:08,040 --> 00:10:10,160
我們內部的氛圍比較寬鬆

252
00:10:10,160 --> 00:10:13,480
不採用KPI OKR等考試方式

253
00:10:13,480 --> 00:10:18,720
也因此我們歡迎那些有比較強的自我驅動力的人加入

254
00:10:18,720 --> 00:10:19,560
在這裡

255
00:10:19,560 --> 00:10:22,560
每個人可以根據自己的能力和興趣

256
00:10:22,560 --> 00:10:25,120
選擇自己研究的方向

257
00:10:25,240 --> 00:10:26,920
即使是剛畢業的新人

258
00:10:26,920 --> 00:10:30,480
也有機會去主導去探索一個全新的領域

259
00:10:30,480 --> 00:10:36,080
並且團隊中其他人會給他提供足夠的研究資源上的支持

260
00:10:36,080 --> 00:10:39,360
我們團隊中有一位去年剛畢業的本科生

261
00:10:39,360 --> 00:10:41,760
基於自己獨特的研究經歷

262
00:10:41,760 --> 00:10:47,160
提出了一種全新的從另類數據裡面提取信息的方法

263
00:10:47,160 --> 00:10:49,520
三個月之後在他剛轉正的時候

264
00:10:49,520 --> 00:10:54,160
策略就上線了取得了很好的效果

265
00:10:54,160 --> 00:10:55,080
在換方

266
00:10:55,080 --> 00:10:57,880
我們非常鼓勵這種創新和嘗試

267
00:10:57,880 --> 00:11:01,680
鼓勵團隊成員之間的互相幫助

268
00:11:01,680 --> 00:11:03,560
三人行必有我師

269
00:11:03,560 --> 00:11:05,600
在換方更是如此

270
00:11:05,600 --> 00:11:08,960
每一位成員都有自己的特長

271
00:11:08,960 --> 00:11:10,840
有些人擅長寫代碼

272
00:11:10,840 --> 00:11:13,720
會幫助同事優化執行效率

273
00:11:13,720 --> 00:11:15,880
有些人樹立能力特別強

274
00:11:15,880 --> 00:11:17,840
會熱衷於幫別人推公式

275
00:11:17,840 --> 00:11:20,240
寫算法做分析

276
00:11:20,240 --> 00:11:23,560
有的人對股票市場理解非常深刻

277
00:11:23,560 --> 00:11:24,680
會主動的

278
00:11:25,080 --> 00:11:27,480
和其他人進行分享

279
00:11:27,480 --> 00:11:29,800
我們有一套合理的評估方式

280
00:11:29,800 --> 00:11:32,360
選擇使用哪些模型交易

281
00:11:32,360 --> 00:11:34,480
確定模型的權重

282
00:11:34,480 --> 00:11:36,240
我們也有同樣完善的方式

283
00:11:36,240 --> 00:11:38,840
去評估每一位成員的貢獻

284
00:11:38,840 --> 00:11:42,080
大家的貢獻不僅僅來自於信號是否盈利

285
00:11:42,080 --> 00:11:45,720
也不僅僅來自於優化組合減少風險

286
00:11:45,720 --> 00:11:47,360
我們同時還會考慮

287
00:11:47,360 --> 00:11:49,760
對周圍成員的輸出貢獻

288
00:11:49,760 --> 00:11:53,400
以及是否持續努力和創新

289
00:11:53,400 --> 00:11:54,880
大家一起齊心協力

290
00:11:54,880 --> 00:11:56,560
出最優秀的模型

291
00:11:56,560 --> 00:11:59,200
和市場上最出名的人一起競爭

292
00:11:59,200 --> 00:12:01,400
是這個工作最吸引人的地方

