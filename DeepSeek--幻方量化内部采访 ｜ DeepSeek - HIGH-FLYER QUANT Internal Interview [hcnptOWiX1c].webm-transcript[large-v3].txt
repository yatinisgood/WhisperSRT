假如你有1万张A100显卡你将如何去管理使用它们呢我是换方的AI应用工程师刚刚的问题就是我的工作日常这并不是什么算力反尔赛虽然社交网站上把上千卡跑一次的大模型调侃为豪门但从我的角度来看要让这个算力巨兽发挥出它真正的战力除了兴奋更多的是挑战它不仅仅是把千卡甚至万卡堆积起来使用这只能说只是个开始而我们团队所需要构建的是双倍甚至于三倍于传统集群使用率的AI基础设施让一行代码就可以轻松调用的AI训练服务想做成这样的事情非常的不容易我们也没有前任的经验可以参考从集群节点拓扑结构的设计到PyTouch深度学习框架的改良存储 网络 通讯 算子优化等等都需要我们自己扎根进去基于硬件的特性不断的去试错在内外用户的使用反馈当中去进行迭代和升级比如我入职后不久就碰到的集群升级之后模型训练突然就降速的问题这些任务读取数据非常的缓慢Checkpoint也没有保存成功在debug的过程当中网上也没有任何的资料能给我们作为参考我们从软件层的一个个的断点去排查到硬件设备的插拔轮换前后几轮复盘之后最终才定位到原来这个问题的元凶是大小两个网络交换机协议冲突的一个问题而最终我们的解决方案也被英伟达官方所收录作为案例提供给了其他的开发者也就在那个时候开始让我突然觉得原来我们已经是一个站在了全球技术前沿的团队了现在呢每天有上千个AI大模型在换方营火平台上进行训练服务着金融量化NLP生物分子结构预测自动驾驶等诸多前沿场景每当看到模型的训练快速的完成并且跑出经验的效果都会让我觉得大家所做的事情非常的有价值有一种AI时代的使命感身处在这个团队给我的感觉就是快乐很幸运能够和天才们一起共事我们提出一个问题能获得无数的回响而不是身边只有没有想法小说一句一只小土豆瞪着无辜的大眼睛问你该怎么办空留你一个人在荒野里面呼号前阵子我们在讨论一个核心算子的时候某提到这个算子它GPU使用率不是很高有没有更多提升空间了当时我是持怀疑态度的毕竟这是官方提供的算子是当时最快的实现他们有最硬件架构最深刻的理解但最终的结果也只有这样那我们来看看那我们还能做些什么呢但我们并没有放弃毕竟人生苦短何妨一试和我们的同学一起苦闷挣扎山重水负了一个月之后那天我在回家路上看上去依旧是毫无收获的一天他电话给我说哎呀他说他走在路上一阵凉风袭来他突然之间领悟了而现在版本在最弱的情况下比官方快了五倍普遍情况下快了25%直接帮我们节省了25%的GPU时间这就是我们做事的方式我们的追求并不仅仅在我比过去快了多少我比之前的代码快了25%我们追求的是我达到理论的最大值是百分之多少比如我们的存储指标是用了IB带宽的百分之多少从80%到85%到91% 92% 93%这一步步跑了很多年这种人会下滑上来而这种1% 1%的极限追求和突破在此之前都是不敢想象的程序员其实并不害怕困难我宁可为了1%的性能突破但经节律一个月也不要面向谷歌编程写一些没有挑战的代码虽然很难但我并不会感到累反而后者这些枯燥的编程会消磨一个人的天赋我们已经站在非常前沿的位置遇到的都是各种全新的问题而和科研天才们一起死磕一个问题带来激情是难以想象的而最终功课难题所带来的成就感就是我作为程序员所能得到的最大快乐作为一个优秀的软件工程师你理想的工作是什么样子的呢你又有没有想过你那一身出色的技能到底能够创造出什么样的价值呢我们思考过这个问题发现答案大概就是成就感这种成就感来自于工程落地创造的巨大商业价值往大了说它来自于站在世界技术的前沿引领了方向制造标准举例而言我们用来为迪奥训练读取样本的变形文件系统非常的快它快到一个什么地步呢我们根本就不需要用缓存来帮助我们提升读取的速度从服务端的磁盘到应用的buffer没有一次内存拷贝从硬盘到内存内存到网卡然后就直接从客户端的网卡来到了应用的buffer里我们针对读取的每一步都做了分析和优化干掉了所有的内存拷贝也就得到了极致的性能我们还有先进的任务级分时调度系统超高性能的AI算子以及能够将迪奥训练延伸到多台机器上并发执行的通讯框架这一切都是由一个年轻的充满活力的萤火工程师团队在短短几年的应用实战中打造出来的而接下来软件的极致提升硬件性能的进一步压榨更多无人踏足过的技术难题将带给我们更多的挑战而萤火团队会依然带着骄傲一起分发身处这样一个团队当中会是一种理想的工作状态由成就感驱动了我们创造了想象不到的价值2016年在AlphaGo击败李适时后不久我们上线了第一个深度学习的模型最初的模型只是一个MLP网络模型很简单但有着让人惊叹的建模能力从那以后我们一直在深度学习方面进行持续投入现在序列模型不仅可以利用当下的信息还能灵活地使用过去几分钟几天甚至几个月发生的事件自然源处理让模型学会理解新闻快人一步对信息做出反应图神经网络可以整合产业链数据发掘公司之间的关系同时对整个市场进行建模利用强化学习交易的细节可以随着市场的变化自主地改进通过对抗训练模型可以抑制自己的过度自信避免落入历史的陷阱我们几乎涉及了深度学习的所有领域并且时刻保持对前沿发展方向的密切关注想尽一切办法来提升预测能力借助AI的力量我们能够更加精准地理解市场让资产价格能够更加迅速更加完整地反映现实世界的规律我们希望AI为我们带来的收益可以反过来推动技术科学研究的进一步发展我们赞助和推动的科研和量化交易无关而是无人驾驶生物制药等方向截止到2022年第一季度萤火AI超算已经服务了50多个国内外的高效实验室以及科研机构累计提供了超过270万小时的GPU算力在协助科研机构使用萤火超算的同时我们也在着手建立自己的科研团队让顶尖的头脑可以借助AI的力量进一步拓展科学的边界从图像分类到机器翻译从围棋布局到蛋白结构AI在一个个领域攻城掠地但是对于AI是否能够用于资产定价并且进行交易盈利的问题却一直存在巨大的争议在金融市场中大家盈利的方式可谓八仙过海各显神通有宏观分析股票的基本面分析还有行为金融学等等所有的参与者随着市场变化而不断挑战过去的自己挑战现在的对手挑战未知的前路与学术界常见的围棋游戏CVNLP等任务相比股价预测是一个参与玩家众多信息不完整信照比极低数据分布不断变化的时序预测问题加博弈问题复杂程度高一个量级以上正因为如此它很有趣并且充满挑战像一个超大的一字出续集的开放式游戏你可以使用任何道具可以充值买显卡算力装备可以不断壮大自己的队伍在游戏中你会遇到新的对手会遇到策略失效也会因为新的进展而兴奋同时收获金钱和成就感不能把研究结果公诸于众或许是唯一的遗憾因为众所周知的策略必将失效而这正是很多人说AI无法预测股价的原因从数据处理到模型调优每一个坑都需要踩过来在这条漫长曲折的道路上披荆斩棘前行时时间和市场最为丰厚的回报官方有一个非常扁平而灵活的团队架构我们鼓励内部不同小组的成员之间自由交流和合作去最大化我们整体的创新能力我们内部的氛围比较宽松不采用KPI OKR等考试方式也因此我们欢迎那些有比较强的自我驱动力的人加入在这里每个人可以根据自己的能力和兴趣选择自己研究的方向即使是刚毕业的新人也有机会去主导去探索一个全新的领域并且团队中其他人会给他提供足够的研究资源上的支持我们团队中有一位去年刚毕业的本科生基于自己独特的研究经历提出了一种全新的从另类数据里面提取信息的方法三个月之后在他刚转正的时候策略就上线了取得了很好的效果在换方我们非常鼓励这种创新和尝试鼓励团队成员之间的互相帮助三人行必有我师在换方更是如此每一位成员都有自己的特长有些人擅长写代码会帮助同事优化执行效率有些人树立能力特别强会热衷于帮别人推公式写算法做分析有的人对股票市场理解非常深刻会主动的和其他人进行分享我们有一套合理的评估方式选择使用哪些模型交易确定模型的权重我们也有同样完善的方式去评估每一位成员的贡献大家的贡献不仅仅来自于信号是否盈利也不仅仅来自于优化组合减少风险我们同时还会考虑对周围成员的输出贡献以及是否持续努力和创新大家一起齐心协力出最优秀的模型和市场上最出名的人一起竞争是这个工作最吸引人的地方